# 厂房在线项目服务器操作手册``
## 服务器介绍
目前服务器分布如下:

- 机房: 两台
    服务器序列|公网IP|对应功能(生产环境)
 	---|---|---
 	服务器1|电信58.215.139.9 联通122.192.68.98|文件分布式T节点;反向代理服务器;厂房在线项目;对应域名:se.cfzxzz.com
 	服务器2|电信58.215.139.113 联通122.192.68.40|文件分布式S节点(节点1,以后有需要可以无限增加节点);数据库服务器.对应域名:st.hengchuangyun.com
 	 
- 办公室: 两台

	服务器序列|内网IP|对应功能(备份)
 	 ---|---|---
 	 服务器3|192.168.1.247(CENTOS系统)|容灾备份,用来同步文件存储节点上(st.hengchuangyun.com)的文件;工作方式为每天凌晨2:30分开始检测和同步工作
 	 服务器4|192.168.1.179(WINDOWS SERVER2008)|用来备份数据库服务器(st.hengchuangyun.com)上的数据库;目前有4个数据库,工作方式为每间隔1个小时,同步一次

## 服务器启用服务明细:

   1. 服务器1启用服务列表:
   	  - 文件分布式Track服务
   	  - 厂房在线项目 (zob_cfzx) 
   	  - 文件分布式反向代理服务及__负载均衡((暂时用不到))__ nginx
      
   2. 服务器2启用服务列表
   	  - 文件分布式存储服务器
   	  - Postgresql 数据库服务器 
   	  - 文件分布式反向解析服务 
   	  - 容灾系统(远程备份)

   3. 服务器3启用服务列表
   	  - 容灾系统(远程备份)

   4. 服务器4启用服务列表
   	  - WINDOWS定时任务  

## 服务器对应服务的开启方式(___非必须情况,请勿进行任何操作___)

   1. 服务器1启用服务列表:
   	  - 文件分布式Track服务
   	  	
   	  `workstart (已经设置为开机启动)`  
   	   	  
   	  - 厂房在线项目 (zob_cfzx) 

   	  `/opt/zob_cfzx/tools/startofbiz.sh`
   	  
   	  - 文件分布式反向代理服务及__负载均衡((暂时用不到))__ nginx

      `ngxstart`
   2. 服务器2启用服务列表
   	  - 文件分布式存储服务器(重启)

		`workrestart (已经设置为开机启动)` 
		   	  
   	  - Postgresql 数据库服务器

   	  	`/etc/init.d/postgresql start` 
   	  	
   	  - 文件分布式反向解析服务 

   	  	`ngxstart`
   	  
   3. 服务器3启用服务列表
   	  - 容灾系统,远程备份文件 
		已经启用定时任务,请勿操作!
   4. 服务器4启用服务列表
   	  - WINDOWS定时任务  
		已经启用定时任务,请勿操作!

## 服务器对应其他命令

- 重启服务命令:
   1. 服务器1启用服务列表: 
   	  - 重启文件分布式Track服务
   	  	
   	  `workrestart`   	  

	  - 重启厂房在线项目 (zob_cfzx) 

   	  ```
   	  /opt/zob_cfzx/tools/stopofbiz.sh
   	  /opt/zob_cfzx/tools/startofbiz.sh
   	  ```
   	  
   	  - 重启文件分布式反向代理服务及__负载均衡((暂时用不到))__ nginx

      `ngxrestart.sh`
      

      - 更新厂房在线的项目
      
         ```      
         [root@localhost ~]# cd /opt/zob_cfzx/		&nbsp;&nbsp;&nbsp;&nbsp;//进入项目所在的路径
         
         [root@localhost zob_cfzx]# git pull		&nbsp;&nbsp;&nbsp;&nbsp;//更新项目
         
         Username for 'https://git.oschina.net': web0377@qq.com 	&nbsp;&nbsp;&nbsp;&nbsp;//输入账号
         
	     Password for 'https://web0377@qq.com @git.oschina.net':	&nbsp;&nbsp;&nbsp;&nbsp;//输入密码
	     ```
	     
	     

   2. 服务器2启用服务列表
   	  - 重启文件分布式存储服务器

		`workrestart`
				 	  
   	  - 重启Postgresql 数据库服务器

   	  	`/etc/init.d/postgresql restart` 
   	  - 重启文件分布式反向解析服务 

   	  	`ngxrestart.sh`
   	  
   3. 服务器3启用服务列表
   	  - 容灾系统,远程备份文件  
		已经启用定时任务,请勿操作!
   4. 服务器4启用服务列表
   	  - WINDOWS定时任务  
		已经启用定时任务,请勿操作!

- 关闭服务命令

   1. 服务器1启用服务列表:
   	  - 关闭文件分布式Track服务
   	  	
   	  `workstop`
   	     	  
   	  - 关闭厂房在线项目 (zob_cfzx) 

   	  `/opt/zob_cfzx/tools/stopofbiz.sh`
   	  
   	  - 关闭文件分布式反向代理服务及__负载均衡((暂时用不到))__ nginx

      `ngxstop.sh`
      
   2. 服务器2启用服务列表
   	  - 关闭文件分布式存储服务器

		`workstop `
		    	  
   	  - 关闭Postgresql 数据库服务器

   	  	`/etc/init.d/postgresql stop` 
   	  	
   	  - 关闭文件分布式反向解析服务 

   	  	`ngxstop.sh`
   	  
   3. 服务器3启用服务列表
   	  - 容灾系统,远程备份文件  
		已经启用定时任务,请勿操作!
   4. 服务器4启用服务列表
   	  - WINDOWS定时任务  
		已经启用定时任务,请勿操作!